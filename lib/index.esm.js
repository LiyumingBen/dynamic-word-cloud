import{defineComponent as t,ref as e,reactive as n,onMounted as o,computed as a,openBlock as i,createElementBlock as d,Fragment as r,renderList as s,normalizeStyle as l,toDisplayString as c,withDirectives as u,createElementVNode as p,vShow as h}from"vue";import{useMouseInElement as m}from"@vueuse/core";var y=t({name:"DynamicWordCloudVue3",props:{data:{required:!0,type:Array},color:{required:!1,type:Array,default:()=>["#2D4DB6","#04B67C","#D1AF07","#E27914","#CB4A4D","#B02690"]},speed:{required:!1,type:Number,default:400},direction:{required:!1,type:String,default:"-1"}},setup(t,{emit:i}){const d=e(null),r=n({width:0,height:0,contentEle:[],animateID:null,curIndex:-1,curItem:{},isShowTip:!1});r.contentEle=t.data&&t.data.map((()=>({x:0,y:0,z:0,style:{}})));const s=()=>{l(),c(),u(),r.animateID=window.requestAnimationFrame(s)},l=()=>{const e=["-1","1"].includes(t.direction)?Math.PI/(1/0):Math.PI/(Number(t.direction)/2*Number(t.speed)),n=Math.cos(e),o=Math.sin(e);r.contentEle=r.contentEle.map((t=>{const e=t.y*n-t.z*o,a=t.z*n+t.y*o;return{...t,y:e,z:a}}))},c=()=>{const e=["-2","2"].includes(t.direction)?Math.PI/(1/0):Math.PI/(Number(t.direction)*Number(t.speed)),n=Math.cos(e),o=Math.sin(e);r.contentEle=r.contentEle.map((t=>{const e=t.x*n-t.z*o,a=t.z*n+t.x*o;return{...t,x:e,z:a}}))},u=()=>{const t=r.width/2,e=r.height/2;r.contentEle=r.contentEle.map((n=>{const{x:o,y:a,z:i}=n,d=(r.width-50)/2,s=500/(500-i),l=(i+d)/(2*d),c=`translate(${o+t-30+"px"}, ${a+e-15+"px"}) scale(${s})`;return{x:o,y:a,z:i,style:{...n.style,opacity:l+.5,zIndex:parseInt((100*s).toString(),10),transform:c}}}))};o((()=>{const e=document.getElementById("wordCloud");r.width=e&&e.clientWidth,r.height=e&&e.clientHeight,(()=>{const e=(r.width-50)/2,n=(r.height-50)/2;if(r.contentEle=[],t.data&&t.data.length)for(let o=0;o<t.data.length;o+=1){const a=(2*(o+1)-1)/t.data.length-1,i=Math.acos(a),d=i*Math.sqrt(t.data.length*Math.PI),s={x:e*Math.sin(i)*Math.cos(d),y:n*Math.sin(i)*Math.sin(d),z:e*Math.cos(i),style:{}};r.contentEle.push(s)}s()})()}));const{x:p,y:h,isOutside:y}=m(d),x=a((()=>(t,e,n)=>n&&{left:t+"px",top:e+"px"}));return{state:r,stop:()=>{r.curIndex=-1,r.isShowTip=!0,window.cancelAnimationFrame(r.animateID)},start:(t,e)=>{r.curIndex=t,r.curItem=e,r.isShowTip=!1,s()},wordClick:t=>{i("wordClick",t)},tooltipStyle:x,x:p,y:h,isOutside:y}}});const x={id:"wordCloud",class:"wordCloud__tagBall"},f=["onMouseleave","onClick"];!function(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===n&&o.firstChild?o.insertBefore(a,o.firstChild):o.appendChild(a),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t))}}('@charset "UTF-8";\n.wordCloud__tagBall[data-v-019946c7] {\n  position: relative;\n  width: 100%;\n  height: 100%;\n}\n\n.wordCloud__tag[data-v-019946c7] {\n  display: block;\n  position: absolute;\n  left: 0px;\n  top: 0px;\n  text-decoration: none;\n  font-size: 15px;\n  font-family: "微软雅黑";\n  font-weight: bold;\n  cursor: pointer;\n}\n\n.wordCloud__tag[data-v-019946c7]:hover {\n  font-size: 25px;\n}\n\n.tooltip[data-v-019946c7] {\n  position: absolute;\n  color: #000;\n  background: #fff;\n  z-index: 99999;\n  font-size: 12px !important;\n  padding: 5px 10px;\n  display: inline;\n  border-radius: 4px;\n  background-color: #fff;\n  box-shadow: rgba(0, 0, 0, 0.1) 2px 2px 8px;\n}\n\n.wordCloud__home[data-v-019946c7] {\n  display: flex;\n  justify-content: center;\n}'),y.render=function(t,e,n,o,a,m){return i(),d("div",x,[(i(!0),d(r,null,s(t.data,((n,o)=>(i(),d("span",{ref_for:!0,ref:"target",class:"wordCloud__tag",key:o,style:l({color:t.color[o%t.color?.length],...t.state.contentEle[o]?.style}),onMouseenter:e[0]||(e[0]=(...e)=>t.stop&&t.stop(...e)),onMouseleave:e=>t.start(o,n),onClick:e=>t.wordClick(n)},c(n.name),45,f)))),128)),u(p("div",{class:"tooltip",style:l(t.tooltipStyle(t.x,t.y,t.isOutside))},c(t.state.curItem.name),5),[[h,t.state.isShowTip]])])},y.__scopeId="data-v-019946c7",y.__file="packages/dynamic-word-cloud/index.vue",y.install=t=>{t.component(y.name,y)};const g=[y];var w={install:t=>{g.map((e=>t.component(e.name,e)))}};export{y as DynamicWordCloudVue3,w as default};
